{% extends "dashboard/dashboard_base.html"%}
{% block title %}Reports - Sujata Associates{% endblock %}

{% block content %}
<div class="dashboard-header">
  <h1><i class="bi bi-graph-up"></i> Company Reports & Analytics</h1>
  <p class="text-muted">Comprehensive business intelligence and financial insights</p>
</div>

<!-- Filter Section -->
<div class="filter-section mb-4">
  <div class="card">
    <div class="card-body">
      <div class="row align-items-center">
        <div class="col-12 col-md-3">
          <label class="form-label">Date Range</label>
          <select class="form-select" id="dateRange">
            <option value="current_month">Current Month</option>
            <option value="last_month">Last Month</option>
            <option value="current_quarter">Current Quarter</option>
            <option value="last_quarter">Last Quarter</option>
            <option value="current_year" selected>Current Year</option>
            <option value="last_year">Last Year</option>
            <option value="custom">Custom Range</option>
          </select>
        </div>
        <div class="col-12 col-md-3">
          <label class="form-label">From Date</label>
          <input type="date" class="form-control" id="fromDate" value="2024-01-01">
        </div>
        <div class="col-12 col-md-3">
          <label class="form-label">To Date</label>
          <input type="date" class="form-control" id="toDate" value="2024-12-31">
        </div>
        <div class="col-12 col-md-3">
          <label class="form-label">&nbsp;</label>
          <div class="d-flex flex-column flex-md-row gap-2">
            <button class="btn btn-primary" onclick="applyFilters()">
              <i class="bi bi-funnel"></i> Apply Filters
            </button>
            <button class="btn btn-outline-secondary" onclick="exportReport()">
              <i class="bi bi-download"></i> Export
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Key Metrics Cards -->
<div class="metrics-row">
  <div class="metric-card">
    <div class="metric-title">Total Projects</div>
    <div class="metric-value">45</div>
    <div class="metric-subtitle">
      <span class="text-success">32 Completed</span> | 
      <span class="text-warning">8 Pending</span> | 
      <span class="text-info">5 Upcoming</span>
    </div>
  </div>
  
  <div class="metric-card">
    <div class="metric-title">Total Revenue</div>
    <div class="metric-value">₹24,50,000</div>
    <div class="metric-subtitle">
      <i class="bi bi-arrow-up text-success"></i> 15.2% from last year
    </div>
  </div>
  
  <div class="metric-card">
    <div class="metric-title">Total Expenses</div>
    <div class="metric-value">₹18,50,000</div>
    <div class="metric-subtitle">
      <i class="bi bi-arrow-up text-warning"></i> 8.7% from last year
    </div>
  </div>
  
  <div class="metric-card">
    <div class="metric-title">Net Profit</div>
    <div class="metric-value">₹6,00,000</div>
    <div class="metric-subtitle">
      <i class="bi bi-percent"></i> 24.5% Profit Margin
    </div>
  </div>
</div>

<!-- Charts Row -->
<div class="charts-row">
  <!-- Revenue vs Expenses Chart -->
  <div class="chart-card">
    <h3><i class="bi bi-bar-chart"></i> Revenue vs Expenses</h3>
    <div class="chart-container-mobile">
      <canvas id="revenueExpensesChart"></canvas>
    </div>
  </div>
  
  <!-- Project Status Distribution -->
  <div class="chart-card">
    <h3><i class="bi bi-pie-chart"></i> Project Status Distribution</h3>
    <div class="chart-container-mobile">
      <canvas id="projectStatusChart"></canvas>
    </div>
  </div>
</div>

<!-- Department & Expense Analysis -->
<div class="charts-row">
  <!-- Department Expenses -->
  <div class="chart-card">
    <h3><i class="bi bi-building"></i> Department-wise Expenses</h3>
    <div class="department-expenses">
      <div class="expense-item">
        <div class="expense-header">
          <span class="expense-name">IT Department</span>
          <span class="expense-amount">₹4,50,000</span>
        </div>
        <div class="expense-bar">
          <div class="expense-fill" style="width: 24.3%; background: linear-gradient(90deg, #3498db, #2c3e50);"></div>
        </div>
        <div class="expense-percentage">24.3%</div>
      </div>
      <div class="expense-item">
        <div class="expense-header">
          <span class="expense-name">Sales & Marketing</span>
          <span class="expense-amount">₹3,80,000</span>
        </div>
        <div class="expense-bar">
          <div class="expense-fill" style="width: 20.5%; background: linear-gradient(90deg, #3498db, #2c3e50);"></div>
        </div>
        <div class="expense-percentage">20.5%</div>
      </div>
      <div class="expense-item">
        <div class="expense-header">
          <span class="expense-name">Human Resources</span>
          <span class="expense-amount">₹3,20,000</span>
        </div>
        <div class="expense-bar">
          <div class="expense-fill" style="width: 17.3%; background: linear-gradient(90deg, #3498db, #2c3e50);"></div>
        </div>
        <div class="expense-percentage">17.3%</div>
      </div>
      <div class="expense-item">
        <div class="expense-header">
          <span class="expense-name">Operations</span>
          <span class="expense-amount">₹2,80,000</span>
        </div>
        <div class="expense-bar">
          <div class="expense-fill" style="width: 15.1%; background: linear-gradient(90deg, #3498db, #2c3e50);"></div>
        </div>
        <div class="expense-percentage">15.1%</div>
      </div>
      <div class="expense-item">
        <div class="expense-header">
          <span class="expense-name">Finance</span>
          <span class="expense-amount">₹2,20,000</span>
        </div>
        <div class="expense-bar">
          <div class="expense-fill" style="width: 11.9%; background: linear-gradient(90deg, #3498db, #2c3e50);"></div>
        </div>
        <div class="expense-percentage">11.9%</div>
      </div>
      <div class="expense-item">
        <div class="expense-header">
          <span class="expense-name">Administration</span>
          <span class="expense-amount">₹2,00,000</span>
        </div>
        <div class="expense-bar">
          <div class="expense-fill" style="width: 10.8%; background: linear-gradient(90deg, #3498db, #2c3e50);"></div>
        </div>
        <div class="expense-percentage">10.8%</div>
      </div>
    </div>
  </div>
  
  <!-- Expense Categories -->
  <div class="chart-card">
    <h3><i class="bi bi-tags"></i> Expense Categories</h3>
    <div class="chart-container-mobile">
      <canvas id="expenseCategoriesChart"></canvas>
    </div>
  </div>
</div>

<!-- Top Projects & Employee Performance -->
<div class="charts-row">
  <!-- Top Performing Projects -->
  <div class="chart-card">
    <h3><i class="bi bi-trophy"></i> Top Performing Projects</h3>
    <div class="projects-list">
      <div class="project-item">
        <div class="project-info">
          <div class="project-name">E-commerce Platform</div>
          <div class="project-status status-completed">Completed</div>
        </div>
        <div class="project-metrics">
          <div class="metric">
            <span class="metric-label">Revenue</span>
            <span class="metric-value">₹4,50,000</span>
          </div>
          <div class="metric">
            <span class="metric-label">Profit</span>
            <span class="metric-value text-success">₹1,80,000</span>
          </div>
        </div>
      </div>
      <div class="project-item">
        <div class="project-info">
          <div class="project-name">Mobile App Development</div>
          <div class="project-status status-completed">Completed</div>
        </div>
        <div class="project-metrics">
          <div class="metric">
            <span class="metric-label">Revenue</span>
            <span class="metric-value">₹3,80,000</span>
          </div>
          <div class="metric">
            <span class="metric-label">Profit</span>
            <span class="metric-value text-success">₹1,52,000</span>
          </div>
        </div>
      </div>
      <div class="project-item">
        <div class="project-info">
          <div class="project-name">Website Redesign</div>
          <div class="project-status status-in-progress">In Progress</div>
        </div>
        <div class="project-metrics">
          <div class="metric">
            <span class="metric-label">Revenue</span>
            <span class="metric-value">₹3,20,000</span>
          </div>
          <div class="metric">
            <span class="metric-label">Profit</span>
            <span class="metric-value text-success">₹1,28,000</span>
          </div>
        </div>
      </div>
      <div class="project-item">
        <div class="project-info">
          <div class="project-name">CRM System</div>
          <div class="project-status status-completed">Completed</div>
        </div>
        <div class="project-metrics">
          <div class="metric">
            <span class="metric-label">Revenue</span>
            <span class="metric-value">₹2,80,000</span>
          </div>
          <div class="metric">
            <span class="metric-label">Profit</span>
            <span class="metric-value text-success">₹1,12,000</span>
          </div>
        </div>
      </div>
      <div class="project-item">
        <div class="project-info">
          <div class="project-name">Digital Marketing Campaign</div>
          <div class="project-status status-completed">Completed</div>
        </div>
        <div class="project-metrics">
          <div class="metric">
            <span class="metric-label">Revenue</span>
            <span class="metric-value">₹2,50,000</span>
          </div>
          <div class="metric">
            <span class="metric-label">Profit</span>
            <span class="metric-value text-success">₹1,00,000</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Employee Performance -->
  <div class="chart-card">
    <h3><i class="bi bi-people"></i> Employee Performance</h3>
    <div class="employee-list">
      <div class="employee-item">
        <div class="employee-info">
          <div class="employee-name">Rajesh Kumar</div>
          <div class="employee-department">IT</div>
        </div>
        <div class="employee-metrics">
          <div class="metric">
            <span class="metric-label">Projects</span>
            <span class="metric-value">8</span>
          </div>
          <div class="metric">
            <span class="metric-label">Revenue</span>
            <span class="metric-value">₹3,20,000</span>
          </div>
          <div class="metric">
            <span class="metric-label">Rating</span>
            <span class="metric-value">
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
            </span>
          </div>
        </div>
      </div>
      <div class="employee-item">
        <div class="employee-info">
          <div class="employee-name">Priya Sharma</div>
          <div class="employee-department">Sales</div>
        </div>
        <div class="employee-metrics">
          <div class="metric">
            <span class="metric-label">Projects</span>
            <span class="metric-value">6</span>
          </div>
          <div class="metric">
            <span class="metric-label">Revenue</span>
            <span class="metric-value">₹2,80,000</span>
          </div>
          <div class="metric">
            <span class="metric-label">Rating</span>
            <span class="metric-value">
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star text-muted"></i>
            </span>
          </div>
        </div>
      </div>
      <div class="employee-item">
        <div class="employee-info">
          <div class="employee-name">Amit Singh</div>
          <div class="employee-department">Marketing</div>
        </div>
        <div class="employee-metrics">
          <div class="metric">
            <span class="metric-label">Projects</span>
            <span class="metric-value">5</span>
          </div>
          <div class="metric">
            <span class="metric-label">Revenue</span>
            <span class="metric-value">₹2,40,000</span>
          </div>
          <div class="metric">
            <span class="metric-label">Rating</span>
            <span class="metric-value">
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star text-muted"></i>
            </span>
          </div>
        </div>
      </div>
      <div class="employee-item">
        <div class="employee-info">
          <div class="employee-name">Sneha Patel</div>
          <div class="employee-department">IT</div>
        </div>
        <div class="employee-metrics">
          <div class="metric">
            <span class="metric-label">Projects</span>
            <span class="metric-value">7</span>
          </div>
          <div class="metric">
            <span class="metric-label">Revenue</span>
            <span class="metric-value">₹2,60,000</span>
          </div>
          <div class="metric">
            <span class="metric-label">Rating</span>
            <span class="metric-value">
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star text-muted"></i>
            </span>
          </div>
        </div>
      </div>
      <div class="employee-item">
        <div class="employee-info">
          <div class="employee-name">Vikram Gupta</div>
          <div class="employee-department">Operations</div>
        </div>
        <div class="employee-metrics">
          <div class="metric">
            <span class="metric-label">Projects</span>
            <span class="metric-value">4</span>
          </div>
          <div class="metric">
            <span class="metric-label">Revenue</span>
            <span class="metric-value">₹2,00,000</span>
          </div>
          <div class="metric">
            <span class="metric-label">Rating</span>
            <span class="metric-value">
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star-fill text-warning"></i>
              <i class="bi bi-star text-muted"></i>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Detailed Tables -->
<div class="charts-row">
  <!-- Monthly Revenue Table -->
  <div class="chart-card">
    <h3><i class="bi bi-calendar-month"></i> Monthly Revenue Breakdown</h3>
    <div class="table-responsive">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Month</th>
            <th>Revenue</th>
            <th>Expenses</th>
            <th>Profit</th>
            <th>Margin</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Jan</strong></td>
            <td>₹1,80,000</td>
            <td>₹1,40,000</td>
            <td class="text-success">₹40,000</td>
            <td><span class="badge bg-success">22.2%</span></td>
          </tr>
          <tr>
            <td><strong>Feb</strong></td>
            <td>₹2,20,000</td>
            <td>₹1,60,000</td>
            <td class="text-success">₹60,000</td>
            <td><span class="badge bg-success">27.3%</span></td>
          </tr>
          <tr>
            <td><strong>Mar</strong></td>
            <td>₹2,00,000</td>
            <td>₹1,50,000</td>
            <td class="text-success">₹50,000</td>
            <td><span class="badge bg-success">25.0%</span></td>
          </tr>
          <tr>
            <td><strong>Apr</strong></td>
            <td>₹2,50,000</td>
            <td>₹1,80,000</td>
            <td class="text-success">₹70,000</td>
            <td><span class="badge bg-success">28.0%</span></td>
          </tr>
          <tr>
            <td><strong>May</strong></td>
            <td>₹2,80,000</td>
            <td>₹2,00,000</td>
            <td class="text-success">₹80,000</td>
            <td><span class="badge bg-success">28.6%</span></td>
          </tr>
          <tr>
            <td><strong>Jun</strong></td>
            <td>₹3,00,000</td>
            <td>₹2,20,000</td>
            <td class="text-success">₹80,000</td>
            <td><span class="badge bg-success">26.7%</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  
  <!-- Expense Categories Table -->
  <div class="chart-card">
    <h3><i class="bi bi-list-check"></i> Detailed Expense Categories</h3>
    <div class="table-responsive">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Category</th>
            <th>Amount</th>
            <th>Percentage</th>
            <th>Trend</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Employee Salaries</strong></td>
            <td>₹8,50,000</td>
            <td>
              <div class="progress" style="height: 8px;">
                <div class="progress-bar" style="width: 45.9%"></div>
              </div>
              <small class="text-muted">45.9%</small>
            </td>
            <td><i class="bi bi-arrow-up text-warning"></i></td>
          </tr>
          <tr>
            <td><strong>Office Rent</strong></td>
            <td>₹2,40,000</td>
            <td>
              <div class="progress" style="height: 8px;">
                <div class="progress-bar" style="width: 13.0%"></div>
              </div>
              <small class="text-muted">13.0%</small>
            </td>
            <td><i class="bi bi-arrow-up text-warning"></i></td>
          </tr>
          <tr>
            <td><strong>Technology & Software</strong></td>
            <td>₹1,80,000</td>
            <td>
              <div class="progress" style="height: 8px;">
                <div class="progress-bar" style="width: 9.7%"></div>
              </div>
              <small class="text-muted">9.7%</small>
            </td>
            <td><i class="bi bi-arrow-down text-success"></i></td>
          </tr>
          <tr>
            <td><strong>Marketing & Advertising</strong></td>
            <td>₹1,60,000</td>
            <td>
              <div class="progress" style="height: 8px;">
                <div class="progress-bar" style="width: 8.6%"></div>
              </div>
              <small class="text-muted">8.6%</small>
            </td>
            <td><i class="bi bi-arrow-down text-success"></i></td>
          </tr>
          <tr>
            <td><strong>Utilities</strong></td>
            <td>₹1,20,000</td>
            <td>
              <div class="progress" style="height: 8px;">
                <div class="progress-bar" style="width: 6.5%"></div>
              </div>
              <small class="text-muted">6.5%</small>
            </td>
            <td><i class="bi bi-arrow-down text-success"></i></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Additional Styles -->
<style>
.filter-section {
  background: var(--card-bg);
  border-radius: 10px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.department-expenses {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.expense-item {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.expense-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: 500;
}

.expense-bar {
  height: 8px;
  background: #f8f9fa;
  border-radius: 4px;
  overflow: hidden;
}

.expense-fill {
  height: 100%;
  border-radius: 4px;
  transition: width 0.3s ease;
}

.expense-percentage {
  font-size: 0.85rem;
  color: #666;
  text-align: right;
}

.projects-list, .employee-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.project-item, .employee-item {
  padding: 1rem;
  background: #f8f9fa;
  border-radius: 8px;
  border-left: 4px solid var(--secondary-color);
}

.project-info, .employee-info {
  margin-bottom: 0.5rem;
}

.project-name, .employee-name {
  font-weight: 600;
  color: var(--primary-color);
}

.project-status {
  font-size: 0.8rem;
  padding: 0.25rem 0.5rem;
  border-radius: 12px;
  display: inline-block;
  margin-top: 0.25rem;
}

.status-completed { background: #d4edda; color: #155724; }
.status-in-progress { background: #cce5ff; color: #004085; }
.status-pending { background: #fff3cd; color: #856404; }

.project-metrics, .employee-metrics {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.metric {
  display: flex;
  flex-direction: column;
  align-items: center;
  min-width: 80px;
}

.metric-label {
  font-size: 0.75rem;
  color: #666;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.metric-value {
  font-weight: 600;
  color: var(--primary-color);
}

.employee-department {
  font-size: 0.85rem;
  color: #666;
  font-style: italic;
}

.table th {
  background: var(--sidebar-bg);
  color: white;
  border: none;
  font-weight: 500;
}

.table td {
  border-color: #f8f9fa;
  vertical-align: middle;
}

.progress {
  background: #f8f9fa;
}

.progress-bar {
  background: var(--secondary-color);
}

.chart-container-mobile {
  position: relative;
  height: 300px;
  width: 100%;
}

/* Prevent horizontal overflow on mobile */
html, body, .main-content {
  overflow-x: hidden;
}

canvas {
  max-width: 100% !important;
  width: 100% !important;
  height: 100% !important;
  display: block;
}

/* Ensure proper mobile layout */
@media screen and (max-width: 768px) {
  .row {
    margin-left: 0 !important;
    margin-right: 0 !important;
  }
  
  .row > * {
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  .card, .chart-card, .metric-card {
    overflow-x: hidden;
  }
  
  .card {
    margin: 0 !important;
  }
  
  .card-body {
    padding: 1rem !important;
  }
}

/* Mobile Responsive Styles */
@media screen and (max-width: 768px) {
  .main-content {
    margin-left: 0 !important;
    padding: 0.5rem !important;
  }
  
  .dashboard-header {
    padding: 0.5rem;
    margin-bottom: 1rem;
    text-align: center;
  }
  
  .dashboard-header h1 {
    font-size: 1.3rem;
    margin-bottom: 0.5rem;
    line-height: 1.2;
  }
  
  .dashboard-header p {
    font-size: 0.85rem;
    margin-bottom: 0;
  }
  
  .filter-section {
    margin: 0 0 1rem 0;
  }
  
  .filter-section .card-body {
    padding: 0.75rem;
  }
  
  .filter-section .row {
    flex-direction: column;
    gap: 0.75rem;
  }
  
  .filter-section .col-md-3 {
    width: 100% !important;
    margin-bottom: 0;
  }
  
  .filter-section .form-label {
    font-size: 0.9rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
  }
  
  .filter-section .form-select,
  .filter-section .form-control {
    font-size: 0.9rem;
    padding: 0.6rem 0.75rem;
  }
  
  .filter-section .d-flex.gap-2 {
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .filter-section .btn {
    width: 100%;
    font-size: 0.9rem;
    padding: 0.75rem;
    border-radius: 8px;
  }
  
  .metrics-row {
    display: block !important; /* override base grid */
    gap: 0.75rem;
    margin: 0 0 1rem 0;
    overflow: hidden;
    padding-bottom: 0;
  }
  
  .metric-card {
    padding: 0.75rem;
    margin: 0 0 0.75rem 0;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    width: 100% !important;
  }
  
  .metric-title {
    font-size: 0.8rem;
    margin-bottom: 0.5rem;
  }
  
  .metric-value {
    font-size: 1.6rem;
    margin-bottom: 0.25rem;
  }
  
  .metric-subtitle {
    font-size: 0.75rem;
    line-height: 1.3;
  }
  
  .charts-row {
    display: block !important; /* override base grid */
    gap: 1rem;
    margin: 0 0 1rem 0;
    overflow: hidden;
    padding-bottom: 0;
  }
  
  .chart-card {
    padding: 1rem;
    margin: 0 0 1rem 0;
    width: 100% !important;
  }
  
  .chart-card h3 {
    font-size: 1rem;
    margin-bottom: 1rem;
  }
  
  .chart-container-mobile {
    height: 250px !important;
  }
  
  .department-expenses {
    gap: 0.75rem;
  }
  
  .expense-item {
    gap: 0.5rem;
  }
  
  .expense-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.25rem;
  }
  
  .expense-name {
    font-size: 0.9rem;
    font-weight: 600;
  }
  
  .expense-amount {
    font-size: 0.85rem;
  }
  
  .expense-percentage {
    font-size: 0.8rem;
  }
  
  .projects-list, .employee-list {
    gap: 0.75rem;
  }
  
  .project-item, .employee-item {
    padding: 0.75rem;
  }
  
  .project-metrics, .employee-metrics {
    flex-direction: column;
    gap: 0.5rem;
    align-items: flex-start;
  }
  
  .metric {
    min-width: auto;
    flex-direction: row;
    justify-content: space-between;
    width: 100%;
  }
  
  .metric-label {
    font-size: 0.75rem;
  }
  
  .metric-value {
    font-size: 0.9rem;
  }
  
  .project-name, .employee-name {
    font-size: 0.95rem;
  }
  
  .employee-department {
    font-size: 0.8rem;
  }
  
  .table-responsive {
    font-size: 0.8rem;
  }
  
  .table th, .table td {
    padding: 0.5rem 0.25rem;
    font-size: 0.8rem;
  }
  
  .table th {
    font-size: 0.75rem;
  }
}

@media screen and (max-width: 480px) {
  .main-content {
    padding: 0.5rem !important;
  }
  
  .dashboard-header {
    padding: 0.5rem;
  }
  
  .dashboard-header h1 {
    font-size: 1.2rem;
  }
  
  .dashboard-header p {
    font-size: 0.8rem;
  }
  
  .filter-section .card-body {
    padding: 0.75rem;
  }
  
  .metric-card {
    padding: 0.75rem;
  }
  
  .metric-value {
    font-size: 1.5rem;
  }
  
  .chart-card {
    padding: 0.75rem;
  }
  
  .chart-card h3 {
    font-size: 0.9rem;
  }
  
  .chart-container-mobile {
    height: 200px !important;
  }
  
  .expense-name {
    font-size: 0.85rem;
  }
  
  .expense-amount {
    font-size: 0.8rem;
  }
  
  .project-name, .employee-name {
    font-size: 0.9rem;
  }
  
  .employee-department {
    font-size: 0.75rem;
  }
  
  .table th, .table td {
    padding: 0.25rem;
    font-size: 0.75rem;
  }
  
  .table th {
    font-size: 0.7rem;
  }
  
  .btn {
    font-size: 0.8rem;
    padding: 0.6rem;
  }
}

/* Additional Mobile Enhancements */
@media screen and (max-width: 768px) {
  /* Better touch targets */
  .btn, .form-control, .form-select {
    min-height: 44px;
  }
  
  /* Improved card shadows for mobile */
  .card {
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
    border: none;
  }
  
  /* Better spacing for mobile */
  .mb-4 {
    margin-bottom: 1rem !important;
  }
  
  /* Improved table mobile experience */
  .table-responsive {
    border-radius: 8px;
    box-shadow: 0 1px 6px rgba(0, 0, 0, 0.1);
  }
  
  /* Better mobile chart containers */
  .chart-container-mobile {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 0.5rem;
  }
  
  /* Mobile-friendly project/employee cards */
  .project-item, .employee-item {
    box-shadow: 0 1px 6px rgba(0, 0, 0, 0.08);
    border: none;
    border-radius: 8px;
  }
  
  /* Better mobile text contrast */
  .text-muted {
    color: #6c757d !important;
  }
  
  /* Improved mobile form styling */
  .form-control:focus, .form-select:focus {
    border-color: var(--secondary-color);
    box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
  }
}
</style>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// Revenue vs Expenses Chart
const revenueExpensesCtx = document.getElementById('revenueExpensesChart').getContext('2d');
const revenueExpensesChart = new Chart(revenueExpensesCtx, {
  type: 'line',
  data: {
    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
    datasets: [{
      label: 'Revenue',
      data: [180000, 220000, 200000, 250000, 280000, 300000, 320000, 290000, 310000, 330000, 350000, 380000],
      borderColor: '#27ae60',
      backgroundColor: 'rgba(39, 174, 96, 0.1)',
      tension: 0.4,
      fill: true
    }, {
      label: 'Expenses',
      data: [140000, 160000, 150000, 180000, 200000, 220000, 240000, 210000, 230000, 250000, 270000, 290000],
      borderColor: '#e74c3c',
      backgroundColor: 'rgba(231, 76, 60, 0.1)',
      tension: 0.4,
      fill: true
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        position: 'top',
        labels: {
          font: {
            size: window.innerWidth <= 768 ? 10 : 12
          }
        }
      }
    },
    scales: {
      y: {
        beginAtZero: true,
        ticks: {
          font: {
            size: window.innerWidth <= 768 ? 10 : 12
          },
          callback: function(value) {
            return '₹' + value.toLocaleString();
          }
        }
      },
      x: {
        ticks: {
          font: {
            size: window.innerWidth <= 768 ? 10 : 12
          }
        }
      }
    }
  }
});

// Project Status Chart
const projectStatusCtx = document.getElementById('projectStatusChart').getContext('2d');
const projectStatusChart = new Chart(projectStatusCtx, {
  type: 'doughnut',
  data: {
    labels: ['Completed', 'In Progress', 'Pending', 'On Hold'],
    datasets: [{
      data: [32, 8, 3, 2],
      backgroundColor: ['#27ae60', '#3498db', '#f39c12', '#e74c3c'],
      borderWidth: 0
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        position: 'bottom',
        labels: {
          font: {
            size: window.innerWidth <= 768 ? 10 : 12
          }
        }
      }
    }
  }
});

// Expense Categories Chart
const expenseCategoriesCtx = document.getElementById('expenseCategoriesChart').getContext('2d');
const expenseCategoriesChart = new Chart(expenseCategoriesCtx, {
  type: 'bar',
  data: {
    labels: ['Employee Salaries', 'Office Rent', 'Technology', 'Marketing', 'Utilities', 'Travel', 'Supplies', 'Insurance', 'Training', 'Other'],
    datasets: [{
      label: 'Amount (₹)',
      data: [850000, 240000, 180000, 160000, 120000, 100000, 80000, 60000, 50000, 10000],
      backgroundColor: 'rgba(52, 152, 219, 0.8)',
      borderColor: '#3498db',
      borderWidth: 1
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        display: false
      }
    },
    scales: {
      y: {
        beginAtZero: true,
        ticks: {
          font: {
            size: window.innerWidth <= 768 ? 10 : 12
          },
          callback: function(value) {
            return '₹' + value.toLocaleString();
          }
        }
      },
      x: {
        ticks: {
          font: {
            size: window.innerWidth <= 768 ? 8 : 12
          },
          maxRotation: window.innerWidth <= 768 ? 90 : 45
        }
      }
    }
  }
});

// Filter Functions
function applyFilters() {
  const dateRange = document.getElementById('dateRange').value;
  const fromDate = document.getElementById('fromDate').value;
  const toDate = document.getElementById('toDate').value;
  
  console.log('Applying filters:', { dateRange, fromDate, toDate });
  
  // Show loading state
  const applyBtn = document.querySelector('.btn-primary');
  const originalText = applyBtn.innerHTML;
  applyBtn.innerHTML = '<i class="bi bi-hourglass-split"></i> Loading...';
  applyBtn.disabled = true;
  
  // Simulate API call
  setTimeout(() => {
    applyBtn.innerHTML = originalText;
    applyBtn.disabled = false;
    alert('Filters applied successfully!');
  }, 2000);
}

function exportReport() {
  alert('Export functionality would generate a comprehensive report in PDF/Excel format.');
}

// Initialize date range functionality
document.getElementById('dateRange').addEventListener('change', function() {
  const today = new Date();
  const fromDateInput = document.getElementById('fromDate');
  const toDateInput = document.getElementById('toDate');
  
  switch(this.value) {
    case 'current_month':
      fromDateInput.value = new Date(today.getFullYear(), today.getMonth(), 1).toISOString().split('T')[0];
      toDateInput.value = new Date(today.getFullYear(), today.getMonth() + 1, 0).toISOString().split('T')[0];
      break;
    case 'last_month':
      fromDateInput.value = new Date(today.getFullYear(), today.getMonth() - 1, 1).toISOString().split('T')[0];
      toDateInput.value = new Date(today.getFullYear(), today.getMonth(), 0).toISOString().split('T')[0];
      break;
    case 'current_year':
      fromDateInput.value = new Date(today.getFullYear(), 0, 1).toISOString().split('T')[0];
      toDateInput.value = new Date(today.getFullYear(), 11, 31).toISOString().split('T')[0];
      break;
    case 'last_year':
      fromDateInput.value = new Date(today.getFullYear() - 1, 0, 1).toISOString().split('T')[0];
      toDateInput.value = new Date(today.getFullYear() - 1, 11, 31).toISOString().split('T')[0];
      break;
  }
});
</script>
{% endblock %}